% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother

\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Asset management : Risque de valorisation ( valorisation d'obligation)},
  pdfauthor={Cheryl Kouadio; Sous la supervision de : Fai√ßal HIHI},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{Asset management : Risque de valorisation ( valorisation
d'obligation)}
\author{Cheryl Kouadio \and Sous la supervision de : Fai√ßal HIHI}
\date{2025-03-23}

\begin{document}
\maketitle


Le risque de valorisation est le risque que la valeur d'un actif
financier soit inf√©rieure √† sa valeur comptable ou √† sa valeur de
march√©. Ce risque peut √™tre caus√© par des fluctuations des taux
d'int√©r√™t, des changements dans la qualit√© de cr√©dit de l'√©metteur, ou
d'autres facteurs √©conomiques et financiers. Dans le cadre de nos
travaux, nous allons nous interesser √† la valorisation d'une obligation.

\paragraph{D√©finition d'une
obligation}\label{duxe9finition-dune-obligation}

Une obligation est un titre de cr√©ance √©mis par une entreprise ou une
collectivit√© publique afin de financer un projet ou de refinancer une
dette. Contrairement aux actions, qui conf√®rent un droit de propri√©t√©,
les obligations sont des instruments de dette qui garantissent aux
investisseurs des paiements p√©riodiques sous forme d'int√©r√™ts (coupons)
et le remboursement du capital √† une √©ch√©ance d√©termin√©e.

Pour la valoriser, comme pour valoriser n'importe quel produit, nous
devons faire l'esp√©rance de la valeur actualis√©e des flux futurs sous la
probabilit√© risque neutre. En effet, cela permet de se mettre sous la
perspective d'un investisseur qui est indiff√©rent au risque et qui ne
demande qu'√† √™tre r√©mun√©r√© pour le temps qu'il pr√™te son argent.

\[
X_{t=0} = \mathbb{E}^Q \left[ e^{-r(T-t)} X_T \right]
\]

La valorisation d'une obligation repose principalement sur deux notions
fondamentales :

\begin{itemize}
\tightlist
\item
  Le taux d'int√©r√™t : il repr√©sente le co√ªt du capital et refl√®te la
  r√©mun√©ration exig√©e par les investisseurs pour pr√™ter leur argent. Il
  peut √™tre per√ßu comme le ``loyer'' du capital pr√™t√© ou encore comme la
  compensation pour le risque associ√© √† l'investissement. Ce taux
  influence directement la valeur d'une obligation, car une hausse des
  taux entra√Æne g√©n√©ralement une baisse du prix des obligations
  existantes sur le march√© secondaire.
\item
  Le taux de recouvrement : il correspond au pourcentage du capital que
  les investisseurs peuvent esp√©rer r√©cup√©rer en cas de d√©faut de
  l'√©metteur. Un taux de recouvrement √©lev√© signifie que, m√™me en cas de
  faillite, les cr√©anciers peuvent r√©cup√©rer une grande partie de leur
  investissement, tandis qu'un taux faible sugg√®re un risque de perte
  plus important. Historiquement, il est fix√© √† \(R = 40\%\).
\end{itemize}

Valoriser une obligation revient donc √† calculer la valeur actualis√©e
des flux futurs de paiement. De ce fait, cela revient √† valoriser les
coupons, le nominal en cas de non d√©faut de la part de l'√©metteur et le
recouvrement en cas de d√©faut de l'√©metteur.

\paragraph{a. Valorisation des
coupons}\label{a.-valorisation-des-coupons}

Le coupon est le montant que l'√©metteur de l'obligation s'engage √†
verser √† l'investisseur √† intervalles r√©guliers (g√©n√©ralement annuels ou
semestriels) jusqu'√† l'√©ch√©ance de l'obligation. Il est exprim√© en
pourcentage de la valeur nominale de l'obligation et peut √™tre fixe ou
variable, en fonction des modalit√©s de l'√©mission.

Vu √† \(t\), la valeur d'un coupon \(c\) qui sera pay√© √† \(T_i\) est
donn√©e par : \[
N \mathbb{E}^Q \left[ e^{-r(Ti-t)} c \right],
\]

o√π \(c\) est le coupon, \(r\) est le taux d'int√©r√™t sans risque et
\(T_i\) est la date de paiement du coupon. Comme le taux d'int√©r√™t est
constant, et le paiement du coupon d√©pend de la probabilit√© de survie de
l'√©metteur, on peut r√©√©crire la formule pr√©c√©dente comme suit :

\[
N e^{-r(Ti-t)} c \mathbb{P}(\tau > T_i),
\]

o√π \(\mathbb{P}(\tau > T_i)\) est la probabilit√© de survie de l'√©metteur
√† la date \(T_i\). Le mod√®le utilis√© pour la probabilit√© de survie est
le mod√®le √† intensit√© \(\lambda\) de Jarrow et Turnbull. La probabilit√©
de survie est donn√©e par :

\[
\mathbb{P}(\tau > T_i) = e^{-\int_{t}^{T_i} \lambda(s) ds} = e^{-\lambda \int_{t}^{T_i} ds} = e^{-\lambda (T_i - t)}.
\]

De ce fait, la valorisation du coupon est donn√©e par :

\[
C_{t} = \sum_{i=1}^{n} N \times c \times e^{-r(T_i-t)} \times e^{-\lambda (T_i - t)} = \sum_{i=1}^{n} N \times c \times e^{-(r + \lambda) \times (T_i-t)} \mathbb{1}_{T_i \geq t}
\]

\paragraph{b. Valorisation du nominal}\label{b.-valorisation-du-nominal}

Le nominal est le montant demand√© par l'√©metteur. Sa valorisation est
donn√©e par : \[
N_t = N \times e^{-r(T-t)} \times e^{-\lambda (T-t)} \mathbb{1}_{T \geq t}
\]

\paragraph{c.~Valorisation du
recouvrement}\label{c.-valorisation-du-recouvrement}

Pour valoriser le recouvrement, il est n√©cessaire de connaitre la
probabilit√© de d√©faut √† l'instant pr√©cis \(t\).

\[
\begin{aligned}
\mathbb{P}(\tau = u) &= \mathbb{P}(u \leq \tau \leq u + du) \\
&= \mathbb{P}(\tau \geq u) - \mathbb{P}(\tau \geq u + du)\\
&= - \frac{ \mathbb{P}(\tau \geq u + du) - \mathbb{P}(\tau \geq u) }{du} du\\
&= -\frac{\mathbb{P}(\tau \geq u)}{du}du \\
&= \lambda e^{\lambda (u-t)} du
\end{aligned}
\]

De ce fait, la valorisation du recouvrement √† t est : \[
\begin{aligned}
R_t &= \int_t^T N R e^{-rt} \mathbb{P}(\tau = u)  \\
&= \int_t^T N R e^{-rt} \lambda e^{\lambda (u-t)} du \\
&= N \lambda R \times \frac{1 - e^{-(r+\lambda)(T-t)}}{r+\lambda} \mathbb{1}_{T \geq t}
\end{aligned}
\]

En se servant de ces formules, nous pouvons valoriser une obligation de
la mani√®re suivante : \$\$

\begin{aligned}
B_t &= C_t + N_t + R_t \\
&= N \left[ \sum_{i=1}^{n}  c \times e^{-(r + \lambda) \times (T_i
-t)} \mathbb{1}_{T_i \geq t} + e^{-(r+\lambda)(T-t)} \mathbb{1}_{T \geq t} +  \lambda R \times \frac{1 - e^{-(r+\lambda)(T-t)}}{r+\lambda} \mathbb{1}_{T \geq t} \right]
\end{aligned}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}\#}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} Package Imports {-}{-}{-}{-}{-}{-}{-}{-}{-}\#}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}\#}

\ImportTok{import}\NormalTok{ warnings}
\NormalTok{warnings.filterwarnings(}\StringTok{"ignore"}\NormalTok{)}
\ImportTok{import}\NormalTok{ yfinance }\ImportTok{as}\NormalTok{ yf }
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{from}\NormalTok{ scipy.optimize }\ImportTok{import}\NormalTok{ bisect}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ pricing\_bond(t,c,T,r,lambda\_,R,N,dt}\OperatorTok{=}\DecValTok{1}\NormalTok{):}
    \CommentTok{"""}
\CommentTok{    Fonction qui calcule la valeur d\textquotesingle{}une obligation.}
\CommentTok{    t : date actuelle}
\CommentTok{    c : coupon}
\CommentTok{    T : date de maturit√©}
\CommentTok{    r : taux sans risque}
\CommentTok{    lambda\_ : intensit√© de d√©faut}
\CommentTok{    R : taux de recouvrement}
\CommentTok{    N : nominal}
\CommentTok{    """}

    \CommentTok{\#\#\# Valorisation du coupon}
\NormalTok{    Ct }\OperatorTok{=}\NormalTok{ N }\OperatorTok{*}\NormalTok{ c }\OperatorTok{*}\NormalTok{ np.}\BuiltInTok{sum}\NormalTok{([np.exp(}\OperatorTok{{-}}\NormalTok{(r}\OperatorTok{+}\NormalTok{lambda\_) }\OperatorTok{*}\NormalTok{ (Ti }\OperatorTok{{-}}\NormalTok{ t)) }\OperatorTok{*}\NormalTok{ (Ti}\OperatorTok{\textgreater{}=}\NormalTok{t) }\ControlFlowTok{for}\NormalTok{ Ti }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(dt, T}\OperatorTok{+}\NormalTok{dt,dt)])}

    \CommentTok{\#\#\# Valorisation du nominal}
    \CommentTok{\#Proba de survie}
\NormalTok{    PS }\OperatorTok{=}\NormalTok{ np.exp( }\OperatorTok{{-}}\NormalTok{ lambda\_ }\OperatorTok{*}\NormalTok{ (T }\OperatorTok{{-}}\NormalTok{ t))}
\NormalTok{    Nt }\OperatorTok{=}\NormalTok{ N }\OperatorTok{*}\NormalTok{ np.exp( }\OperatorTok{{-}}\NormalTok{r }\OperatorTok{*}\NormalTok{ (T }\OperatorTok{{-}}\NormalTok{ t)) }\OperatorTok{*}\NormalTok{ PS }\OperatorTok{*}\NormalTok{ (T}\OperatorTok{\textgreater{}=}\NormalTok{t)}

    \CommentTok{\#\#\# Valorisation du recouvrement}
    \ControlFlowTok{if}\NormalTok{ (r}\OperatorTok{+}\NormalTok{lambda\_)}\OperatorTok{==}\DecValTok{0}\NormalTok{ :}
\NormalTok{        R\_ }\OperatorTok{=}\NormalTok{ T}\OperatorTok{{-}}\NormalTok{t}
    \ControlFlowTok{else}\NormalTok{ :}
\NormalTok{        R\_ }\OperatorTok{=}\NormalTok{ N }\OperatorTok{*}\NormalTok{ lambda\_ }\OperatorTok{*}\NormalTok{ R }\OperatorTok{*}\NormalTok{ ( }\DecValTok{1} \OperatorTok{{-}}\NormalTok{ np.exp( }\OperatorTok{{-}}\NormalTok{ (r}\OperatorTok{+}\NormalTok{lambda\_) }\OperatorTok{*}\NormalTok{ (T}\OperatorTok{{-}}\NormalTok{t)))}\OperatorTok{/}\NormalTok{(r}\OperatorTok{+}\NormalTok{lambda\_)}
\NormalTok{    Rt }\OperatorTok{=}\NormalTok{ R\_ }\OperatorTok{*}\NormalTok{ (T }\OperatorTok{\textgreater{}=}\NormalTok{ t)}

    \CommentTok{\#\#\# Valorisation de l\textquotesingle{}obligation}
\NormalTok{    Bond }\OperatorTok{=}\NormalTok{ Ct }\OperatorTok{+}\NormalTok{ Nt }\OperatorTok{+}\NormalTok{ Rt}
    \ControlFlowTok{return}\NormalTok{ Bond}
\end{Highlighting}
\end{Shaded}

\subsection{I. Valorisation d'une obligation sans risque de
d√©faut}\label{i.-valorisation-dune-obligation-sans-risque-de-duxe9faut}

Nous souhaitons valoriser une obligation sans risque de d√©faut,
i.e.~\(\lambda = 0\). Pour ce faire, nous fixons les param√®tres suivants
:

\begin{itemize}
\tightlist
\item
  \(N = 1\) : le nominal de l'obligation
\item
  \(r = 0.02\) : le taux d'int√©r√™t sans risque
\item
  \(\lambda = 0\) : l'intensit√© de d√©faut
\item
  \(T = 10\) : l'√©ch√©ance de l'obligation
\item
  \(c = 0.02\) : le coupon annuel
\item
  \(R = 0.4\) : le taux de recouvrement
\item
  \(n = 10\) : le nombre de coupons
\item
  \(t = 0\) : l'instant pr√©sent
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{0}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{T }\OperatorTok{=} \DecValTok{10}
\NormalTok{c }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}

\NormalTok{B\_t }\OperatorTok{=}\NormalTok{ pricing\_bond(t}\OperatorTok{=}\NormalTok{t,c}\OperatorTok{=}\NormalTok{c,T}\OperatorTok{=}\NormalTok{T,r}\OperatorTok{=}\NormalTok{r,lambda\_}\OperatorTok{=}\NormalTok{lambda\_,R}\OperatorTok{=}\NormalTok{R,N}\OperatorTok{=}\NormalTok{N)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Prix de l\textquotesingle{}obligation vu √† t=}\SpecialCharTok{\{}\NormalTok{t}\SpecialCharTok{\}}\SpecialStringTok{ : }\SpecialCharTok{\{}\NormalTok{B\_t}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Prix de l'obligation vu √† t=0 : 0.9981933497987289
\end{verbatim}

En valorisant l'obligation, nous obtenons un prix de
\(B_0 \approx 0.99\). Ce prix est proche du nominal, car les taux de
coupons sont √©gaux au taux de march√©. L'obligation est dite au pair
(Prix = Nominal) car elle r√©mun√®re au taux de march√©. Si \(c > r\), le
prix de l'obligation sera sup√©rieur au nominal, car le march√© se serait
ru√© sur cette obligation, car elle offrirait plus que le taux de march√©.
Sinon, le prix de l'obligation sera inf√©rieur au nominal, car le march√©
serait plus r√©ticent.

\begin{quote}
üí° La condition dans laquelle l'obligation √©mise vaut 100\% du nominal,
i.e.~au pair, est \(c \approx r + \lambda\). C'est une obligation qui
permet de recouvrir ausi bien le risque de taux (\(r\)) et le risque de
cr√©dit li√© √† l'intensit√© de d√©faut (\(\lambda\)). Pour voir ceci, nous
avons impl√©ment√© ci-dessous une fonction qui permet d'extrait le coupon
qui permet d'avoir une obligation au pair, avec les m√™mes param√®tres que
pr√©c√©demment.
\end{quote}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{T }\OperatorTok{=} \DecValTok{10}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}

\CommentTok{\# M√©thode de dichotomie}
\KeywordTok{def}\NormalTok{ trouver\_coupon(t, T, r, lambda\_, R, N, dt}\OperatorTok{=}\DecValTok{1}\NormalTok{, tol}\OperatorTok{=}\FloatTok{1e{-}6}\NormalTok{):}
    \CommentTok{"""}
\CommentTok{    Trouve le coupon c tel que la valeur de l\textquotesingle{}obligation soit √©gale √† N.}
\CommentTok{    """}
    \KeywordTok{def}\NormalTok{ equation(c):}
        \ControlFlowTok{return}\NormalTok{ pricing\_bond(t, c, T, r, lambda\_, R, N, dt) }\OperatorTok{{-}}\NormalTok{ N}
    
\NormalTok{    c\_opt }\OperatorTok{=}\NormalTok{ bisect(equation, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, xtol}\OperatorTok{=}\NormalTok{tol)  }\CommentTok{\# Recherche de c dans l\textquotesingle{}intervalle [0,1]}
    \ControlFlowTok{return}\NormalTok{ c\_opt}

\NormalTok{c\_opt }\OperatorTok{=}\NormalTok{ trouver\_coupon(t}\OperatorTok{=}\NormalTok{t, T}\OperatorTok{=}\NormalTok{T, r}\OperatorTok{=}\NormalTok{r, lambda\_}\OperatorTok{=}\NormalTok{lambda\_, R}\OperatorTok{=}\NormalTok{R, N}\OperatorTok{=}\NormalTok{N)}
\NormalTok{c\_opt}

\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Coupon pour avoir une obligation au pair vu √† t=}\SpecialCharTok{\{}\NormalTok{t}\SpecialCharTok{\}}\SpecialStringTok{ : }\SpecialCharTok{\{}\NormalTok{c\_opt}\SpecialCharTok{:.2\%\}}\SpecialStringTok{"}\NormalTok{)}
\NormalTok{B\_t }\OperatorTok{=}\NormalTok{ pricing\_bond(t}\OperatorTok{=}\NormalTok{t,c}\OperatorTok{=}\NormalTok{c\_opt,T}\OperatorTok{=}\NormalTok{T,r}\OperatorTok{=}\NormalTok{r,lambda\_}\OperatorTok{=}\NormalTok{lambda\_,R}\OperatorTok{=}\NormalTok{R,N}\OperatorTok{=}\NormalTok{N)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Prix de l\textquotesingle{}obligation vu √† t=}\SpecialCharTok{\{}\NormalTok{t}\SpecialCharTok{\}}\SpecialStringTok{ : }\SpecialCharTok{\{}\NormalTok{B\_t}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Coupon pour avoir une obligation au pair vu √† t=0 : 2.64%
Prix de l'obligation vu √† t=0 : 1.000007783902349
\end{verbatim}

\begin{quote}
De plus, lorsque l'intensit√© de d√©faut est tr√®s grande, on retrouve un
prix √† peu pr√®s √©gal au taux de recouvrement. En effet, la probabilit√©
de d√©faut est tr√®s grande et donc la probabilit√© qu'il y ait un
recouvrement est tr√®s √©lev√©e. (voir exemple ci-dessous)
\end{quote}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{10}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{T }\OperatorTok{=} \DecValTok{10}
\NormalTok{c }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}


\NormalTok{B\_t }\OperatorTok{=}\NormalTok{ pricing\_bond(t}\OperatorTok{=}\NormalTok{t,c}\OperatorTok{=}\NormalTok{c,T}\OperatorTok{=}\NormalTok{T,r}\OperatorTok{=}\NormalTok{r,lambda\_}\OperatorTok{=}\NormalTok{lambda\_,R}\OperatorTok{=}\NormalTok{R,N}\OperatorTok{=}\NormalTok{N)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Prix de l\textquotesingle{}obligation vu √† t=}\SpecialCharTok{\{}\NormalTok{t}\SpecialCharTok{\}}\SpecialStringTok{ : }\SpecialCharTok{\{}\NormalTok{B\_t}\SpecialCharTok{:.4f\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Taux de recouvrement : }\SpecialCharTok{\{}\NormalTok{R}\SpecialCharTok{:.4f\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Prix de l'obligation vu √† t=0 : 0.3992
Taux de recouvrement : 0.4000
\end{verbatim}

\subsection{II. Evolution du prix de l'obligation en fonction du
temps}\label{ii.-evolution-du-prix-de-lobligation-en-fonction-du-temps}

Durant la vie de l'obligation, son prix √©volue en fonction des paiements
de coupons. √Ä chaque distribution de coupon, une chute du prix de
l'obligation est observ√©e. Cette baisse s'explique par le fait que,
juste avant le versement, le prix de l'obligation int√®gre la valeur du
coupon √† percevoir. Une fois le coupon pay√© aux d√©tenteurs, cette valeur
dispara√Æt, entra√Ænant m√©caniquement une diminution du prix de
l'obligation, jusqu'√† atteindre le nominal de l'obligation ainsi que le
dernier coupon.

Toutefois, apr√®s cette chute li√©e au d√©tachement du coupon, la valeur de
l'obligation remonte progressivement √† mesure que l'√©ch√©ance du prochain
coupon approche. Ce ph√©nom√®ne cr√©e une √©volution en dents de scie, o√π
chaque baisse correspond √† un paiement de coupon et chaque remont√©e
traduit l'accumulation de la valeur du prochain paiement attendu.

Bien que ce ph√©nom√®ne soit logique et attendu, il peut √™tre per√ßu
n√©gativement car la forme en dents de scie pourrait donner l'impression
d'une d√©gradation de la qualit√© de l'obligation. C'est pourquoi on
distingue deux types de prix :

\begin{itemize}
\tightlist
\item
  Le dirty price (prix sale) : il correspond au prix de l'obligation tel
  qu'affich√© sur le march√©, int√©grant les variations dues aux paiements
  de coupons.
\item
  Le clean price (prix net ou pied de coupon) : il correspond au prix de
  l'obligation ``nettoy√©'' des coupons accumul√©s. Ce prix est obtenu en
  soustrayant les int√©r√™ts courus au dirty price. Ainsi, le clean price
  permet d'√©valuer plus pr√©cis√©ment la valeur intrins√®que de
  l'obligation sans √™tre pollu√© par les variations dues aux paiements
  p√©riodiques de coupons. C'est cette valeur qui est g√©n√©ralement
  utilis√©e pour comparer les obligations entre elles.
\end{itemize}

Pour illustrer cette √©volution, nous avons trac√© l'√©volution du prix de
l'obligation en fonction du temps. Nous avons fix√© les param√®tres
suivants :

\begin{itemize}
\tightlist
\item
  \(N = 1\) : le nominal de l'obligation
\item
  \(r = 0.02\) : le taux d'int√©r√™t sans risque
\item
  \(\lambda = 0.01\) : l'intensit√© de d√©faut
\item
  \(T = 10\) : l'√©ch√©ance de l'obligation
\item
  \(c = 0.03\) : le coupon annuel
\item
  \(R = 0.4\) : le taux de recouvrement
\item
  \(n = 10\) : le nombre de coupons
\item
  \(t = 0\) : l'instant pr√©sent
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ myFloor(x):}
    \ControlFlowTok{if}\NormalTok{ x}\OperatorTok{==}\DecValTok{0}\NormalTok{:}
        \ControlFlowTok{return} \DecValTok{0}
    \ControlFlowTok{if}\NormalTok{ x}\OperatorTok{==}\NormalTok{np.floor(x):}
        \ControlFlowTok{return}\NormalTok{ x}\OperatorTok{{-}}\DecValTok{1}
    \ControlFlowTok{return}\NormalTok{ np.floor(x)}

\KeywordTok{def}\NormalTok{ clean\_price(t,c,T,r,lambda\_,R,N,dt}\OperatorTok{=}\DecValTok{1}\NormalTok{):}
    \CommentTok{"""}
\CommentTok{    Fonction qui calcule le prix d\textquotesingle{}une obligation propre.}
\CommentTok{    """}
\NormalTok{    B\_t }\OperatorTok{=}\NormalTok{ pricing\_bond(t,c,T,r,lambda\_,R,N,dt)}
\NormalTok{    cc }\OperatorTok{=}\NormalTok{ c }\OperatorTok{*}\NormalTok{ (t }\OperatorTok{{-}}\NormalTok{ myFloor(t))}

    \ControlFlowTok{return}\NormalTok{ B\_t }\OperatorTok{{-}}\NormalTok{ cc}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{T }\OperatorTok{=} \DecValTok{10}
\NormalTok{c }\OperatorTok{=} \DecValTok{3}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}


\NormalTok{dirty\_prices }\OperatorTok{=}\NormalTok{ []}
\NormalTok{clean\_prices }\OperatorTok{=}\NormalTok{ []}
\NormalTok{grid\_values\_c }\OperatorTok{=}\NormalTok{ np.arange(}\DecValTok{0}\NormalTok{,T}\OperatorTok{+}\FloatTok{0.001}\NormalTok{,}\FloatTok{0.001}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in}\NormalTok{ grid\_values\_c:}
\NormalTok{    dirty\_prices.append(pricing\_bond(t,c,T,r,lambda\_,R,N))}
\NormalTok{    clean\_prices.append(clean\_price(t,c,T,r,lambda\_,R,N))}


\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\NormalTok{plt.plot(grid\_values\_c,dirty\_prices, label}\OperatorTok{=}\StringTok{"Dirty prices"}\NormalTok{)}
\NormalTok{plt.plot(grid\_values\_c,clean\_prices, label}\OperatorTok{=}\StringTok{"Clean prices"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Dirty prices vs Clean prices"}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{"t"}\NormalTok{)}
\NormalTok{plt.grid()}
\NormalTok{plt.legend()}
\NormalTok{plt.ylabel(}\StringTok{"Prix de l\textquotesingle{}obligation"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Text(0, 0.5, "Prix de l'obligation")
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{TP-3_files/figure-pdf/cell-8-output-2.pdf}}

\subsubsection{a. Cas extr√™mes}\label{a.-cas-extruxeames}

Nous avons analys√© l'√©volution du prix de l'obligation dans deux cas
extr√™mes afin d'observer l'impact du coupon sur la dynamique des prix.
Toutes choses √©gales par ailleurs, nous avons modifi√© le coupon de
l'obligation tout en conservant les autres param√®tres constants. Les
deux sc√©narios √©tudi√©s sont les suivants :

\begin{itemize}
\tightlist
\item
  \$ c = 0.01 \$ : le coupon est inf√©rieur au taux d'int√©r√™t sans
  risque.\\
\item
  \$ c = 0.05 \$ : le coupon est sup√©rieur au taux d'int√©r√™t sans
  risque.
\end{itemize}

\paragraph{Cas 1 : \$ c = 0.01 \$}\label{cas-1-c-0.01}

Lorsque \$ c = 1\% \$ et que ce coupon est inf√©rieur au taux d'int√©r√™t
sans risque \$ r \$, la valeur de l'obligation √©volue de mani√®re
sp√©cifique :

\begin{itemize}
\tightlist
\item
  Au d√©part, l'obligation est escompt√©e car le coupon est faible, et les
  investisseurs anticipent un rendement global inf√©rieur au taux du
  march√©.\\
\item
  √Ä mesure que l'√©ch√©ance approche, l'incertitude sur le paiement du
  coupon dispara√Æt progressivement. Les investisseurs deviennent de plus
  en plus certains que le paiement aura bien lieu.\\
\item
  √Ä la veille du paiement, l'obligation converge vers un prix proche de
  \$ N + c \$ pour le dirty price (car elle inclut le coupon accumul√©)
  et \$ N \$ pour le clean price (qui exclut le coupon accumul√©).
\end{itemize}

Cela signifie que l'obligation s'appr√©cie au fil du temps en raison de
la certitude croissante du paiement des flux futurs. En d'autres termes,
plus l'√©ch√©ance se rapproche, plus l'investisseur est assur√© de recevoir
ses paiements, ce qui entra√Æne une augmentation progressive de la valeur
de l'obligation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{T }\OperatorTok{=} \DecValTok{10}
\NormalTok{c1 }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}

\NormalTok{clean\_prices1 }\OperatorTok{=}\NormalTok{ []}
\NormalTok{dirty\_prices1 }\OperatorTok{=}\NormalTok{ []}
\ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in}\NormalTok{ grid\_values\_c:}
\NormalTok{    B\_t\_dirty }\OperatorTok{=}\NormalTok{ pricing\_bond(t}\OperatorTok{=}\NormalTok{t,c}\OperatorTok{=}\NormalTok{c1,T}\OperatorTok{=}\NormalTok{T,r}\OperatorTok{=}\NormalTok{r,lambda\_}\OperatorTok{=}\NormalTok{lambda\_,R}\OperatorTok{=}\NormalTok{R,N}\OperatorTok{=}\NormalTok{N)}
\NormalTok{    B\_t\_clean }\OperatorTok{=}\NormalTok{ clean\_price(t}\OperatorTok{=}\NormalTok{t,c}\OperatorTok{=}\NormalTok{c1,T}\OperatorTok{=}\NormalTok{T,r}\OperatorTok{=}\NormalTok{r,lambda\_}\OperatorTok{=}\NormalTok{lambda\_,R}\OperatorTok{=}\NormalTok{R,N}\OperatorTok{=}\NormalTok{N)}
\NormalTok{    clean\_prices1.append(B\_t\_clean)}
\NormalTok{    dirty\_prices1.append(B\_t\_dirty)}

\NormalTok{plt.plot(grid\_values\_c,clean\_prices1, label}\OperatorTok{=}\StringTok{"Clean prices"}\NormalTok{)}
\NormalTok{plt.plot(grid\_values\_c,dirty\_prices1, label}\OperatorTok{=}\StringTok{"Dirty prices"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Clean prices vs Dirty prices"}\NormalTok{)}
\NormalTok{plt.legend()}
\NormalTok{plt.grid()}
\NormalTok{plt.xlabel(}\StringTok{"t"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Prix de l\textquotesingle{}obligation"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Text(0, 0.5, "Prix de l'obligation")
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{TP-3_files/figure-pdf/cell-9-output-2.pdf}}

\paragraph{Cas 2 : \$ c = 0.05 \$}\label{cas-2-c-0.05}

Lorsque \$ c = 5\% \$ et que ce coupon est sup√©rieur au taux d'int√©r√™t
sans risque \$ r \$, la dynamique du prix de l'obligation suit une
√©volution inverse :

\begin{itemize}
\tightlist
\item
  Au d√©part, l'obligation est pris√©e au-dessus du nominal (elle se
  n√©gocie avec une prime). Cela s'explique par le fait que son coupon
  g√©n√©reux attire les investisseurs, qui consid√®rent que le rendement
  offert par l'obligation compense largement le risque de cr√©dit et est
  plus attractif que les opportunit√©s de placement √† taux sans risque.\\
\item
  √Ä mesure que l'√©ch√©ance approche, la valeur de l'obligation se
  depr√©cie progressivement. En effet, √† chaque p√©riode, l'investisseur
  re√ßoit un coupon √©lev√©, mais √† l'√©ch√©ance, il ne r√©cup√®re que le
  nominal \$ N \$, ce qui entra√Æne une correction progressive du prix de
  march√©.\\
\item
  √Ä la veille du remboursement, l'obligation converge vers \$ N + c \$
  pour le dirty price (qui inclut le dernier coupon √† verser) et vers \$
  N \$ pour le clean price.
\end{itemize}

Ainsi, cette obligation se d√©pr√©cie progressivement jusqu'√† l'√©ch√©ance,
car l'effet attractif du coupon √©lev√© s'amenuise √† mesure que le
remboursement du capital nominal devient imminent. En d'autres termes,
l'obligation part d'une valeur sup√©rieure √† son nominal mais perd
progressivement sa prime √† l'approche de l'√©ch√©ance.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{T }\OperatorTok{=} \DecValTok{10}
\NormalTok{c2 }\OperatorTok{=} \DecValTok{5}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}

\NormalTok{clean\_prices2 }\OperatorTok{=}\NormalTok{ []}
\NormalTok{dirty\_prices2 }\OperatorTok{=}\NormalTok{ []}
\ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in}\NormalTok{ grid\_values\_c:}
\NormalTok{    B\_t\_dirty }\OperatorTok{=}\NormalTok{ pricing\_bond(t}\OperatorTok{=}\NormalTok{t,c}\OperatorTok{=}\NormalTok{c2,T}\OperatorTok{=}\NormalTok{T,r}\OperatorTok{=}\NormalTok{r,lambda\_}\OperatorTok{=}\NormalTok{lambda\_,R}\OperatorTok{=}\NormalTok{R,N}\OperatorTok{=}\NormalTok{N)}
\NormalTok{    B\_t\_clean }\OperatorTok{=}\NormalTok{ clean\_price(t}\OperatorTok{=}\NormalTok{t,c}\OperatorTok{=}\NormalTok{c2,T}\OperatorTok{=}\NormalTok{T,r}\OperatorTok{=}\NormalTok{r,lambda\_}\OperatorTok{=}\NormalTok{lambda\_,R}\OperatorTok{=}\NormalTok{R,N}\OperatorTok{=}\NormalTok{N)}
\NormalTok{    clean\_prices2.append(B\_t\_clean)}
\NormalTok{    dirty\_prices2.append(B\_t\_dirty)}

\NormalTok{plt.plot(grid\_values\_c,clean\_prices2, label}\OperatorTok{=}\StringTok{"Clean prices"}\NormalTok{)}
\NormalTok{plt.plot(grid\_values\_c,dirty\_prices2, label}\OperatorTok{=}\StringTok{"Dirty prices"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Clean prices vs Dirty prices"}\NormalTok{)}
\NormalTok{plt.legend()}
\NormalTok{plt.grid()}
\NormalTok{plt.xlabel(}\StringTok{"t"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Prix de l\textquotesingle{}obligation"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Text(0, 0.5, "Prix de l'obligation")
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{TP-3_files/figure-pdf/cell-10-output-2.pdf}}

\subsection{III. √âvolution du prix en fonction du taux
d'int√©r√™t}\label{iii.-uxe9volution-du-prix-en-fonction-du-taux-dintuxe9ruxeat}

Le prix d'une obligation est une fonction d√©croissante du taux
d'int√©r√™t. En effet, plus le taux d'int√©r√™t est √©lev√©, plus la valeur
actualis√©e des flux futurs (coupons et remboursement du nominal) est
faible, ce qui r√©duit m√©caniquement le prix de l'obligation.

Dans cette analyse, il est inutile de distinguer le dirty price et le
clean price, car la diff√©rence entre les deux ne d√©pend pas du taux
d'int√©r√™t. De plus, en consid√©rant \$t = 0
\(, il n'y a pas encore d‚Äôint√©r√™ts courus (\)c = 0 \$), donc les deux
prix co√Øncident.

\subsubsection{Obligation au pair}\label{obligation-au-pair}

Autour de \$c - \lambda = 2\% \$, le prix de l'obligation est √©gal au
nominal. Cela s'explique par le fait que le taux de coupon est
exactement √©gal au taux de march√©. L'obligation est alors dite ``au
pair'', car les investisseurs n'ont ni prime ni d√©cote √† appliquer sur
son prix.

\subsubsection{Explication de la relation n√©gative entre prix et
taux}\label{explication-de-la-relation-nuxe9gative-entre-prix-et-taux}

La relation n√©gative entre le prix d'une obligation et le taux d'int√©r√™t
s'explique par l'effet de substitution avec les nouvelles √©missions
obligataires.

\begin{itemize}
\tightlist
\item
  Lorsque les taux d'int√©r√™t augmentent, de nouvelles obligations sont
  √©mises avec des coupons plus attractifs.\\
\item
  En cons√©quence, les obligations existantes, qui offrent un coupon fixe
  plus faible, deviennent moins int√©ressantes pour les investisseurs.
  Leur prix diminue afin d'ajuster leur rendement effectif au nouveau
  niveau des taux du march√©.\\
\item
  Inversement, si les taux d'int√©r√™t baissent, les obligations
  existantes deviennent plus attractives puisqu'elles offrent un coupon
  plus √©lev√© que les nouvelles √©missions, ce qui entra√Æne une hausse de
  leur prix sur le march√© secondaire.
\end{itemize}

Ainsi, la sensibilit√© d'une obligation aux variations de taux d'int√©r√™t,
appel√©e ``duration'', est un √©l√©ment cl√© dans l'√©valuation du risque de
taux et la gestion de portefeuille obligataire.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{T }\OperatorTok{=} \DecValTok{10}
\NormalTok{c }\OperatorTok{=}\DecValTok{3}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}

\NormalTok{dirty\_prices }\OperatorTok{=}\NormalTok{ []}
\NormalTok{grid\_values\_r }\OperatorTok{=}\NormalTok{ np.arange(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\FloatTok{0.001}\NormalTok{) }
\ControlFlowTok{for}\NormalTok{ r }\KeywordTok{in}\NormalTok{ grid\_values\_r:}
\NormalTok{    B\_t\_dirty }\OperatorTok{=}\NormalTok{ pricing\_bond(t}\OperatorTok{=}\NormalTok{t,c}\OperatorTok{=}\NormalTok{c,T}\OperatorTok{=}\NormalTok{T,r}\OperatorTok{=}\NormalTok{r,lambda\_}\OperatorTok{=}\NormalTok{lambda\_,R}\OperatorTok{=}\NormalTok{R,N}\OperatorTok{=}\NormalTok{N)}
\NormalTok{    dirty\_prices.append(B\_t\_dirty)}

\NormalTok{plt.plot(grid\_values\_r,dirty\_prices, label}\OperatorTok{=}\StringTok{"Dirty prices"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Prix de l\textquotesingle{}obligation en fonction du taux d\textquotesingle{}int√©r√™t"}\NormalTok{)}
\NormalTok{plt.legend()}
\NormalTok{plt.grid()}
\NormalTok{plt.xlabel(}\StringTok{"r"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Prix de l\textquotesingle{}obligation"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Text(0, 0.5, "Prix de l'obligation")
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{TP-3_files/figure-pdf/cell-11-output-2.pdf}}

\subsection{IV. Sensibilit√© du prix de l'obligation au taux d'int√©r√™t /
Duration}\label{iv.-sensibilituxe9-du-prix-de-lobligation-au-taux-dintuxe9ruxeat-duration}

La duration est une mesure de la sensibilit√© du prix d'une obligation
aux variations du taux d'int√©r√™t. Elle permet d'√©valuer le risque de
taux, c'est-√†-dire l'impact d'une variation des taux sur la valeur de
l'obligation.

\begin{quote}
Dans le cas de l'√©volution du prix en fonction du taux d'int√©r√™t, la
duration sera donc la pente de la courbe repr√©sentant cette relation.
\end{quote}

Math√©matiquement, la duration est d√©finie comme la d√©riv√©e du prix de
l'obligation par rapport au taux d'int√©r√™t :

\[
\delta = - \frac{d B_t}{d r} \times \frac{1}{B_t}
\]

En utilisant une approximation en diff√©rences finies, on exprime cette
d√©riv√©e de la mani√®re suivante :

\[
\frac{d B_t}{d r}  \approx \frac{B_t(r+\Delta r) - B_t(r)}{\Delta r}
\]

Cette sensibilit√© permet de mesurer la variation du prix de l'obligation
en r√©ponse √† une fluctuation du taux d'int√©r√™t, offrant ainsi une
√©valuation directe du risque de taux auquel est expos√© l'investisseur.
De ce fait, si les taux d'int√©r√™t bouge de \(\Delta r\) = 1\%, alors les
prix bougeront de -sensibilit√© * \(\Delta r\) .

Nous allons impl√©menter ce calcul en Python, en prenant \(\Delta r = 1\)
bp (soit \(0.0001\) en notation d√©cimale).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ sensivity\_to\_rate(t,c,T,r,lambda\_,R,N,dt}\OperatorTok{=}\DecValTok{1}\NormalTok{,dr}\OperatorTok{=} \FloatTok{0.01}\OperatorTok{/}\DecValTok{100}\NormalTok{):}
    \CommentTok{"""}
\CommentTok{    Fonction qui calcule la sensibilit√© d\textquotesingle{}une obligation √† un taux d\textquotesingle{}int√©r√™t.}
\CommentTok{    """}
\NormalTok{    B\_t }\OperatorTok{=}\NormalTok{ pricing\_bond(t,c,T,r,lambda\_,R,N,dt)}
\NormalTok{    B\_t\_plus }\OperatorTok{=}\NormalTok{ pricing\_bond(t,c,T,r}\OperatorTok{+}\NormalTok{dr,lambda\_,R,N,dt)}
\NormalTok{    sensivity }\OperatorTok{=} \OperatorTok{{-}}\NormalTok{((B\_t\_plus }\OperatorTok{{-}}\NormalTok{ B\_t)}\OperatorTok{/}\NormalTok{dr) }\OperatorTok{*}\NormalTok{ (}\DecValTok{1}\OperatorTok{/}\NormalTok{B\_t)}
    \ControlFlowTok{return}\NormalTok{ sensivity}
\end{Highlighting}
\end{Shaded}

Si les taux d'int√©r√™t bouge de \(\Delta r\) = 1\%, alors les prix
bougeront de -sensibilit√© * \(\Delta r\) = -8,64 * 1\%. La duration va
√™tre souvent proche de la maturit√©.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{T }\OperatorTok{=} \DecValTok{10}
\NormalTok{c }\OperatorTok{=}\DecValTok{3}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}

\NormalTok{sensivity\_to\_rate(t,c,T,r,lambda\_,R,N)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
np.float64(8.643982489102903)
\end{verbatim}

D'un point de vue graphique, il existe une certaine identit√© entre la
maturit√© et la duration, car cette derni√®re peut √™tre interpr√©t√©e comme
le barycentre des flux futurs de l'obligation. Plus ces flux sont
concentr√©s dans le temps, plus leur pond√©ration affecte la sensibilit√©
du prix aux variations des taux d'int√©r√™t.

\paragraph{Lien entre duration et
maturit√©}\label{lien-entre-duration-et-maturituxe9}

\begin{itemize}
\tightlist
\item
  La duration est une approximation de la dur√©e d'exposition au risque,
  ajust√©e en fonction des flux de paiements.\\
\item
  Elle est souvent proche de la maturit√© moyenne de l'obligation, bien
  que l√©g√®rement inf√©rieure (environ 80\% de la maturit√© totale, en
  fonction des conditions de march√© et du niveau des coupons).
\end{itemize}

Ainsi, plus l'√©ch√©ance de l'obligation se rapproche, plus la duration
tend √† augmenter, car les flux futurs deviennent plus proches dans le
temps, rendant l'obligation plus sensible aux variations des taux
d'int√©r√™t.

\begin{quote}
Lorsque la maturit√© de l'obligation approche, sa sensibilit√© au taux
d'int√©r√™t tend √† augmenter. En effet, la duration peut √™tre interpr√©t√©e
comme une mesure du temps moyen pond√©r√© pendant lequel l'investisseur
est expos√© au risque de taux.
\end{quote}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{c }\OperatorTok{=}\DecValTok{3}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}

\NormalTok{dirty\_prices }\OperatorTok{=}\NormalTok{ []}
\NormalTok{grid\_values\_T }\OperatorTok{=}\NormalTok{ np.arange(}\DecValTok{1}\NormalTok{,}\DecValTok{20}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ T }\KeywordTok{in}\NormalTok{ grid\_values\_T:}
\NormalTok{    B\_t\_dirty }\OperatorTok{=}\NormalTok{ sensivity\_to\_rate(t,c,T,r,lambda\_,R,N)}
\NormalTok{    dirty\_prices.append(B\_t\_dirty)}

\NormalTok{plt.plot(grid\_values\_T,dirty\_prices, label}\OperatorTok{=}\StringTok{"Dirty prices"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Sensibilit√© en fonction de la maturit√©"}\NormalTok{)}
\NormalTok{plt.legend()}
\NormalTok{plt.grid()}
\NormalTok{plt.xlabel(}\StringTok{"T"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Sensibilit√©"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Text(0, 0.5, 'Sensibilit√©')
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{TP-3_files/figure-pdf/cell-14-output-2.pdf}}

\paragraph{Cas particulier : absence de coupon, de taux d'int√©r√™t et de
risque de
d√©faut}\label{cas-particulier-absence-de-coupon-de-taux-dintuxe9ruxeat-et-de-risque-de-duxe9faut}

Lorsque le coupon, le taux d'int√©r√™t et l'intensit√© de d√©faut sont nuls,
la duration est exactement √©gale √† la maturit√© de l'obligation. Puisque
la duration peut √™tre interpr√©t√©e comme le barycentre des flux futurs de
l'obligation, lorsque le coupon et l'intensit√© de d√©faut sont nuls, tous
les flux sont concentr√©s √† l'√©ch√©ance, ce qui √©quivaut √† la maturit√© de
l'obligation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{c }\OperatorTok{=}\NormalTok{ lambda\_ }\OperatorTok{=} \FloatTok{10e{-}6}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}


\NormalTok{dirty\_prices }\OperatorTok{=}\NormalTok{ []}
\ControlFlowTok{for}\NormalTok{ T }\KeywordTok{in}\NormalTok{ grid\_values\_T:}
\NormalTok{    B\_t\_dirty }\OperatorTok{=}\NormalTok{ sensivity\_to\_rate(t,c,T,r,lambda\_,R,N)}
\NormalTok{    dirty\_prices.append(B\_t\_dirty)}

\NormalTok{plt.plot(grid\_values\_T,dirty\_prices, label}\OperatorTok{=}\StringTok{"Dirty prices"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Sensibilit√© au taux en fonction de la maturit√©"}\NormalTok{)}
\NormalTok{plt.legend()}
\NormalTok{plt.grid()}
\NormalTok{plt.xlabel(}\StringTok{"T"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Sensibilit√©"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Text(0, 0.5, 'Sensibilit√©')
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{TP-3_files/figure-pdf/cell-15-output-2.pdf}}

\begin{quote}
Dans le risque de taux, le principale indicateur est la duration.
\end{quote}

\subsection{V. Mod√®lisation de la
VaR}\label{v.-moduxe8lisation-de-la-var}

\subsubsection{V.1. Approche par la
sensibilit√©}\label{v.1.-approche-par-la-sensibilituxe9}

Selon le mod√®le de Hull et White, le taux d'int√©r√™t est mod√©lis√© par :

\[
dr = \theta ( \mu - r) dt + \sigma dW
\]

o√π \(\theta\) est le coefficient de vitesse de r√©version, \(\mu\) est le
taux d'int√©r√™t moyen, \(\sigma\) est la volatilit√© du taux d'int√©r√™t et
\(dW\) est un mouvement brownien. Ce mod√®le a la sp√©cifit√© d'√™tre
normale. De ce fait, \(\Delta r \sim N(0, \sigma^2 \Delta t)\). En
faisant l'approximation de la variation du prix, il est possible
d'approcher une VaR par la sensibilit√© :

\[
\begin{aligned}
Duration &= - \frac{d B_t}{d r} \times \frac{1}{B_t} \\
\frac{d B_t}{B_t} &\approx - Duration \times  \Delta r \\
\end{aligned}
\]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Objectif : √©crire une fonction qui calcule la VaR avec l\textquotesingle{}approche par duration}
\ImportTok{from}\NormalTok{ scipy.stats }\ImportTok{import}\NormalTok{ norm}

\KeywordTok{def}\NormalTok{ sensitive\_VaR(mu,sigma,t,c,T,r,lambda\_,R,N,h,dt}\OperatorTok{=}\DecValTok{1}\NormalTok{,alpha}\OperatorTok{=}\FloatTok{0.99}\NormalTok{) :}
    \CommentTok{"""}
\CommentTok{    Calcul de la VaR gaussienne}
\CommentTok{    data : les rendements logarithmiques}
\CommentTok{    alpha : le niveau de confiance}
\CommentTok{    """}
\NormalTok{    Duration }\OperatorTok{=}\NormalTok{ sensivity\_to\_rate(t,c,T,r,lambda\_,R,N,dt)}

    \ControlFlowTok{return} \OperatorTok{{-}}\NormalTok{(mu }\OperatorTok{+}\NormalTok{ Duration }\OperatorTok{*}\NormalTok{ sigma }\OperatorTok{*}\NormalTok{ np.sqrt(h) }\OperatorTok{*}\NormalTok{ norm.ppf(}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ alpha))}

\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Param√®tres du mod√®le de taux}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\NormalTok{mu }\OperatorTok{=} \DecValTok{0}
\NormalTok{h }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{12}
\NormalTok{sigma }\OperatorTok{=} \FloatTok{0.01}

\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Param√®tres de la valorisation du bond}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{c }\OperatorTok{=}\DecValTok{3}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}
\NormalTok{T}\OperatorTok{=}\DecValTok{10}

\NormalTok{VaR }\OperatorTok{=}\NormalTok{ sensitive\_VaR(mu,sigma,t,c,T,r,lambda\_,R,N,h}\OperatorTok{=}\NormalTok{h,dt}\OperatorTok{=}\DecValTok{1}\NormalTok{,alpha}\OperatorTok{=}\FloatTok{0.99}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"VaR estim√© par l\textquotesingle{}approche par la sensibilit√© : }\SpecialCharTok{\{}\NormalTok{VaR}\SpecialCharTok{:.4\%\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
VaR estim√© par l'approche par la sensibilit√© : 5.8049%
\end{verbatim}

Pour cette estimation, nous avions suppos√© que la volatilit√©
\(\sigma = 1\%\). Cependant, cette hypoth√®se pourrait s'√©carter de la
r√©alit√©. Pour ce faire, nous allons extraire les donn√©es de taux
d'int√©r√™t et calculer la volatilit√© empirique. L'ESTR est un taux un
jour collat√©ralis√©,c'est donc quasiment sans risque. Nous allons donc
utiliser ce taux pour calculer la volatilit√© empirique. Pour cela, nous
allons utiliser l'historique des taux d'int√©r√™t de l'ESTR sur une
p√©riode de 5 ans, i.e.~10/03/2025 - 12/03/2020, disponible sur ce
\href{estr.xlsx}{lien}.

Pour ce faire, nous utilisons la formule suivante :

\[
\sigma = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} (r_i - \bar{r})^2}
\]

Nous constatons que la volatilit√© empirique sur les 5 ans est de
25.45\%. Cette valeur est tr√®s √©lev√©e, ce qui signifie que les taux
d'int√©r√™t ont connu des variations importantes sur cette p√©riode. Cela
peut √™tre du √† la trop grande p√©riode utilis√©e pour la calibration de la
volatilit√©. Pour ce faire, nous avons restreint la p√©riode √† 1 an,
i.e.~10/03/2025 - 10/03/2024. La volatilit√© empirique sur cette p√©riode
est de 1.04\%. Cette valeur est plus coh√©rente avec les taux d'int√©r√™t
sans risque.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\NormalTok{estr\_df }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{"estr.xlsx"}\NormalTok{, skiprows}\OperatorTok{=}\DecValTok{6}\NormalTok{)}
\CommentTok{\#date as date}
\NormalTok{estr\_df[}\StringTok{"Date"}\NormalTok{] }\OperatorTok{=}\NormalTok{ pd.to\_datetime(estr\_df[}\StringTok{"Date"}\NormalTok{], }\BuiltInTok{format}\OperatorTok{=}\StringTok{"\%Y{-}\%m{-}}\SpecialCharTok{\%d}\StringTok{"}\NormalTok{)}
\NormalTok{estr\_df }\OperatorTok{=}\NormalTok{ estr\_df.set\_index(}\StringTok{"Date"}\NormalTok{)}
\NormalTok{estr\_df }\OperatorTok{=}\NormalTok{ estr\_df.sort\_index()}

\NormalTok{estr\_df.head()}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
& PX\_LAST & CHG\_PCT\_1D \\
Date & & \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
2020-03-12 & -0.540 & 0.5525 \\
2020-03-13 & -0.541 & -0.1852 \\
2020-03-16 & -0.536 & 0.9242 \\
2020-03-17 & -0.531 & 0.9328 \\
2020-03-18 & -0.529 & 0.3766 \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vol\_est }\OperatorTok{=}\NormalTok{ np.std(estr\_df[}\StringTok{"PX\_LAST"}\NormalTok{].pct\_change())}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Volatilit√© estim√©e sur 5 ans: }\SpecialCharTok{\{}\NormalTok{vol\_est}\SpecialCharTok{:.4f\}}\SpecialStringTok{"}\NormalTok{)}

\CommentTok{\# volatilit√© sur 1 an}
\NormalTok{vol\_est}\OperatorTok{=}\NormalTok{ np.std(estr\_df.loc[}\StringTok{"2024{-}03{-}10"}\NormalTok{:}\StringTok{"2025{-}03{-}10"}\NormalTok{, }\StringTok{"PX\_LAST"}\NormalTok{].pct\_change())}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Volatilit√© estim√©e sur 1 an : }\SpecialCharTok{\{}\NormalTok{vol\_est}\SpecialCharTok{:.4f\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Volatilit√© estim√©e sur 5 ans: 0.2545
Volatilit√© estim√©e sur 1 an : 0.0104
\end{verbatim}

\subsubsection{V.2. Approche avec un
repricing}\label{v.2.-approche-avec-un-repricing}

Cette approche consiste √† revaloriser, sous l'hypoth√®se de normalit√© des
taux, l'obligation √† l'instant \(t\) pour un taux \(r + \Delta r\) et de
calculer la perte maximale possible. De ce fait, elle est plus pr√©cise
que l'approche par la sensibilit√©.

Puisque dans le cas d'une obligation, ce dont on veut se pr√©munir c'est
de la hausse des taux (puisqu'elle fait baisser le taux d'int√©r√™t). De
ce fait, la VaR est donn√©e par :

\[
\text{VaR} =  - \frac{B_t(r + \Delta r) - B_t }{B_t},
\]

o√π \(\Delta r\) est la variation des taux d'int√©r√™t.

Par d√©finition, la VaR estim√©e sera plus basse que l'autre approche en
raison de la convexit√© de l'√©volution du prix de l'obligation en
fonction des taux d'int√©r√™t. La Var par l'approche de la sensibilit√©,
quant √† elle, suppose une lin√©arit√© de l'√©volution du prix de
l'obligation en fonction des taux d'int√©r√™t.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ repricing\_VaR(mu,sigma,t,c,T,r,lambda\_,R,N,h,dt}\OperatorTok{=}\DecValTok{1}\NormalTok{,alpha}\OperatorTok{=}\FloatTok{0.99}\NormalTok{) :}
    \CommentTok{"""}
\CommentTok{    Calcul de la VaR gaussienne}
\CommentTok{    data : les rendements logarithmiques}
\CommentTok{    alpha : le niveau de confiance}
\CommentTok{    """}
\NormalTok{    delta\_r }\OperatorTok{=}\NormalTok{ mu }\OperatorTok{+}\NormalTok{ sigma }\OperatorTok{*}\NormalTok{ np.sqrt(h) }\OperatorTok{*}\NormalTok{ norm.ppf(alpha)}
\NormalTok{    P\_t }\OperatorTok{=}\NormalTok{ pricing\_bond(t,c,T,r,lambda\_,R,N,dt)}
\NormalTok{    P\_t\_shocked }\OperatorTok{=}\NormalTok{ pricing\_bond(t,c,T,r}\OperatorTok{+}\NormalTok{delta\_r,lambda\_,R,N,dt)}

\NormalTok{    VAR }\OperatorTok{=} \OperatorTok{{-}}\NormalTok{( (P\_t\_shocked }\OperatorTok{{-}}\NormalTok{ P\_t)}\OperatorTok{/}\NormalTok{P\_t)}

    \ControlFlowTok{return}\NormalTok{ VAR, delta\_r}


\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Param√®tres du mod√®le de taux}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{mu }\OperatorTok{=} \DecValTok{0}
\NormalTok{h }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{12}
\NormalTok{sigma }\OperatorTok{=} \FloatTok{0.01}

\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Param√®tres de la valorisation du bond}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{c }\OperatorTok{=}\DecValTok{3}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}
\NormalTok{T}\OperatorTok{=}\DecValTok{10}

\NormalTok{VaR, delta\_r }\OperatorTok{=}\NormalTok{ repricing\_VaR(mu,sigma,t,c,T,r,lambda\_,R,N,h}\OperatorTok{=}\NormalTok{h,dt}\OperatorTok{=}\DecValTok{1}\NormalTok{,alpha}\OperatorTok{=}\FloatTok{0.99}\NormalTok{)}

\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"VaR estim√© par l\textquotesingle{}approche par le r√©ajustement : }\SpecialCharTok{\{}\NormalTok{VaR}\SpecialCharTok{:.4\%\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Choc de taux : }\SpecialCharTok{\{}\NormalTok{delta\_r}\SpecialCharTok{:.2\%\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
VaR estim√© par l'approche par le r√©ajustement : 5.6272%
Choc de taux : 0.67%
\end{verbatim}

\subsection{VI. Focus risque de cr√©dit \&
contrepartie}\label{vi.-focus-risque-de-cruxe9dit-contrepartie}

Le risque de cr√©dit est le risque que l'√©metteur d'une obligation ne
soit pas en mesure de respecter ses engagements financiers, entra√Ænant
ainsi des pertes pour les investisseurs. Ce risque est particuli√®rement
pertinent dans le contexte des obligations, car il peut affecter la
valeur de l'obligation et la capacit√© de l'investisseur √† r√©cup√©rer son
capital. Le risque de contrepartie, quant √† lui, est le risque que la
contrepartie d'une transaction financi√®re ne respecte pas ses
obligations contractuelles. Dans le cas des obligations, cela peut se
traduire par le non-paiement des coupons ou du capital √† l'√©ch√©ance. Ce
risque est particuli√®rement important dans les transactions de gr√© √† gr√©
(OTC), o√π les parties ne sont pas soumises aux m√™mes exigences
r√©glementaires que celles des march√©s organis√©s.

\subsubsection{VI.1. Comment estimer l'intensit√© de d√©faut
?}\label{vi.1.-comment-estimer-lintensituxe9-de-duxe9faut}

Pr√©cedemment, nous avons valoriser l'obligation de la mani√®re suivante :

\[
\begin{aligned}
B_t &= C_t + N_t + R_t \\
&= N \left[ \sum_{i=1}^{n}  c \times e^{-(r + \lambda) \times (T_i
-t)} \mathbb{1}_{T_i \geq t} + e^{-(r+\lambda)(T-t)} \mathbb{1}_{T \geq t} +  \lambda R \times \frac{1 - e^{-(r+\lambda)(T-t)}}{r+\lambda} \mathbb{1}_{T \geq t} \right]
\end{aligned}
\]

et nous avons signfi√© la condition dans laquelle l'obligation √©mise vaut
100\% du nominal, i.e.~au pair, est \(c \approx r + \lambda\).
Cependant, ce n'est pas exact.

Soit un coupon pay√© en continu, la valorisation de l'obligation est
donn√©e par :

\[
\begin{aligned}
B_t &= N \left[ \int_{t}^{T} c e^{-(r + \lambda) \times (u-t)} du + e^{-(r+\lambda)(T-t)} +  \lambda R \times \frac{1 - e^{-(r+\lambda)(T-t)}}{r+\lambda} \right]\\
&= N \left[ \frac{c}{r + \lambda} \left(1 - e^{-(r + \lambda)(T-t)} \right) + e^{-(r+\lambda)(T-t)} +  \lambda R \times \frac{1 - e^{-(r+\lambda)(T-t)}}{r+\lambda} \right]\\
B_t = N &\Leftrightarrow c = r + \lambda (1 - R) \\
& c - r = \lambda (1 - R) 
\end{aligned}
\]

De ce fait, en extrayant \(c\), la condition dans laquelle l'obligation
√©mise vaut 100\% du nominal, i.e.~au pair, est \$c = r + \lambda (1 - R)
\$.

\begin{quote}
üí° \(s = c-r\) est la prime de cr√©dit ou encore le spread de cr√©dit.
C'est la prime que l'investisseur demande pour le risque de cr√©dit. Si
\(c > r\), l'obligation est √©mise √† un prix sup√©rieur √† 100\% du
nominal. Si \(c < r\), l'obligation est √©mise √† un prix inf√©rieur √†
100\% du nominal. Ce spread permet de faire la relation entre la PD
exprim√© par \(\lambda\) et la LGD exprim√© par \(1 -R\). Cette
information est plus facile √† avoir que l'intensit√© de d√©faut car le
spread est cot√© sur le march√© √† travers les CDS. Par d√©finition, on en
d√©duit facilement que plus cettre prime est √©lev√©, plus l'emetteur est
risqu√©.
\end{quote}

\begin{quote}
Take away : Les notions de duration et de spread sont tr√®s importants
dans la mod√©lisation du risque de taux
\end{quote}

\paragraph{cas de l'argentine, pays
risqu√©}\label{cas-de-largentine-pays-risquuxe9}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{s }\OperatorTok{=} \DecValTok{1031}\OperatorTok{/}\DecValTok{10000} 
\NormalTok{R }\OperatorTok{=} \FloatTok{0.4}
\NormalTok{lambda\_ }\OperatorTok{=}\NormalTok{ s }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ R)}
\NormalTok{t}\OperatorTok{=}\DecValTok{0}

\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Spread de cr√©dit : }\SpecialCharTok{\{}\NormalTok{s}\SpecialCharTok{:.2\%\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Recouvrement : }\SpecialCharTok{\{}\NormalTok{R}\SpecialCharTok{:.2\%\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Intensit√© de d√©faut : }\SpecialCharTok{\{}\NormalTok{lambda\_}\SpecialCharTok{:.2\%\}}\SpecialStringTok{"}\NormalTok{)}
\NormalTok{PS }\OperatorTok{=}\NormalTok{ [np.exp( }\OperatorTok{{-}}\NormalTok{ lambda\_ }\OperatorTok{*}\NormalTok{ (T }\OperatorTok{{-}}\NormalTok{ t)) }\ControlFlowTok{for}\NormalTok{ T }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{21}\NormalTok{)]}

\NormalTok{plt.plot(}\BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{21}\NormalTok{),PS)}
\NormalTok{plt.title(}\StringTok{"Probabilit√© de survie en fonction de la maturit√©"}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{"T"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Probabilit√© de survie"}\NormalTok{)}
\NormalTok{plt.grid()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Spread de cr√©dit : 10.31%
Recouvrement : 40.00%
Intensit√© de d√©faut : 17.18%
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{TP-3_files/figure-pdf/cell-20-output-2.pdf}}

\paragraph{cas de la France}\label{cas-de-la-france}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Cas de la France}
\NormalTok{s }\OperatorTok{=} \FloatTok{32.4}\OperatorTok{/}\DecValTok{10000} 
\NormalTok{R }\OperatorTok{=} \FloatTok{0.4}
\NormalTok{lambda\_ }\OperatorTok{=}\NormalTok{ s }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ R)}
\NormalTok{t}\OperatorTok{=}\DecValTok{0}

\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Spread de cr√©dit : }\SpecialCharTok{\{}\NormalTok{s}\SpecialCharTok{:.2\%\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Recouvrement : }\SpecialCharTok{\{}\NormalTok{R}\SpecialCharTok{:.2\%\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Intensit√© de d√©faut : }\SpecialCharTok{\{}\NormalTok{lambda\_}\SpecialCharTok{:.2\%\}}\SpecialStringTok{"}\NormalTok{)}
\NormalTok{PS }\OperatorTok{=}\NormalTok{ [np.exp( }\OperatorTok{{-}}\NormalTok{ lambda\_ }\OperatorTok{*}\NormalTok{ (T }\OperatorTok{{-}}\NormalTok{ t)) }\ControlFlowTok{for}\NormalTok{ T }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{21}\NormalTok{)]}

\NormalTok{plt.plot(}\BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{21}\NormalTok{),PS)}
\NormalTok{plt.title(}\StringTok{"Probabilit√© de survie en fonction de la maturit√©"}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{"T"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Probabilit√© de survie"}\NormalTok{)}
\NormalTok{plt.grid()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Spread de cr√©dit : 0.32%
Recouvrement : 40.00%
Intensit√© de d√©faut : 0.54%
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{TP-3_files/figure-pdf/cell-21-output-2.pdf}}

En comparant les deux pays, l'Argentine et la France. On sait que
l'argentine est un pays plus risqu√© que la France. Cela se voit
√©galement au niveau des spreads de cr√©dit. En effet, le spread de
l'Argentine est plus √©lev√© que celui de la France. Cela signifie que les
investisseurs demandent une prime de risque plus √©lev√©e pour investir
dans des obligations argentines que dans des obligations fran√ßaises. De
plus, en regardant la probabilit√© de survie des deux pays, on constate
que la probabilit√© de survie de l'Argentine est plus faible que celle de
la France. Cela signifie que les investisseurs consid√®rent que
l'Argentine est plus susceptible de faire d√©faut que la France.

\subsubsection{VI.2 Sensibilit√©
cr√©dit}\label{vi.2-sensibilituxe9-cruxe9dit}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ sensivity\_to\_credit(t,c,T,r,lambda\_,R,N,dt}\OperatorTok{=}\DecValTok{1}\NormalTok{,dlambda\_}\OperatorTok{=} \FloatTok{0.01}\OperatorTok{/}\DecValTok{100}\NormalTok{):}
    \CommentTok{"""}
\CommentTok{    Fonction qui calcule la sensibilit√© d\textquotesingle{}une obligation √† un taux d\textquotesingle{}int√©r√™t.}
\CommentTok{    """}
\NormalTok{    B\_t }\OperatorTok{=}\NormalTok{ pricing\_bond(t,c,T,r,lambda\_,R,N,dt)}
\NormalTok{    B\_t\_plus }\OperatorTok{=}\NormalTok{ pricing\_bond(t,c,T,r,lambda\_ }\OperatorTok{+}\NormalTok{ dlambda\_,R,N,dt)}
    
\NormalTok{    sensivity }\OperatorTok{=} \OperatorTok{{-}}\NormalTok{((B\_t\_plus }\OperatorTok{{-}}\NormalTok{ B\_t)}\OperatorTok{/}\NormalTok{dlambda\_) }\OperatorTok{*}\NormalTok{ (}\DecValTok{1}\OperatorTok{/}\NormalTok{B\_t) }\OperatorTok{*}\NormalTok{ (}\DecValTok{1}\OperatorTok{/}\NormalTok{ (}\DecValTok{1}\OperatorTok{{-}}\NormalTok{R))}

    \ControlFlowTok{return}\NormalTok{ sensivity}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{T }\OperatorTok{=} \DecValTok{10}
\NormalTok{c }\OperatorTok{=}\DecValTok{3}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}

\NormalTok{sensivity\_to\_credit(t,c,T,r,lambda\_,R,N,dlambda\_}\OperatorTok{=}\FloatTok{0.01}\OperatorTok{/}\DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
np.float64(8.821190868023761)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{t}\OperatorTok{=}\DecValTok{0}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{c }\OperatorTok{=}\DecValTok{3}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}

\NormalTok{dirty\_prices }\OperatorTok{=}\NormalTok{ []}
\NormalTok{grid\_values\_T }\OperatorTok{=}\NormalTok{ np.arange(}\DecValTok{1}\NormalTok{,}\DecValTok{20}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ T }\KeywordTok{in}\NormalTok{ grid\_values\_T:}
\NormalTok{    B\_t\_dirty }\OperatorTok{=}\NormalTok{ sensivity\_to\_credit(t,c,T,r,lambda\_,R,N)}
\NormalTok{    dirty\_prices.append(B\_t\_dirty)}

\NormalTok{plt.plot(grid\_values\_T,dirty\_prices, label}\OperatorTok{=}\StringTok{"Dirty prices"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Sensibilit√© cr√©dit en fonction de la maturit√©"}\NormalTok{)}
\NormalTok{plt.legend()}
\NormalTok{plt.grid()}
\NormalTok{plt.xlabel(}\StringTok{"T"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Sensibilit√©"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Text(0, 0.5, 'Sensibilit√©')
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{TP-3_files/figure-pdf/cell-24-output-2.pdf}}

Soit le mod√®le normale pour le taux :

\[
dr_t = \theta (\mu - r_t) dt + \sigma_r dW_t
\]

et un mod√®le log normale pour le spread de cr√©dit, puisqu'il ne peut
√™tre n√©gatif : \[
\frac{ds_t}{s_t} = \sigma_s dZ_t
\]

Ces deux mod√®les sont li√©s par \(dW_t dZ_t = \rho dt\). On peut exprimer
cette relation par \(Z_t = \rho W_t + \sqrt{1 - \rho^2} V_t\), o√π
\(V_t\) est un mouvement brownien standard ind√©pendant de \(W_t\). Cette
corr√©lation est positive. \textgreater{} üí° si les taux d'int√©r√™t
montent, le risque de cr√©dit augmente puisque les entreprises ont plus
de mal √† rembourser leur dette. De ce fait, le spread de cr√©dit
augmente.

Supposons qu'on cherche √† calculer une VaR d'horizon \(h\). Pour cela,
il faudra faire des simulations de Monte Carlo pour les deux mod√®les.

\[
\begin{aligned}
r_{t+h} &= r_t + \theta (\mu - r_t) h + \sigma_r \sqrt{h} W_t \\
s_{t+h} &= s_t \exp(\sigma_s \sqrt{h} Z_t) \\
ou \quad s_{t+h} &= s_t (1 + \sigma_s \sqrt{h} Z_t) \quad (\text{par DL})
\end{aligned}
\]

Posons les param√®tres suivants :

\begin{itemize}
\tightlist
\item
  \(\theta = 0.1\) : le coefficient de vitesse de r√©version
\item
  \(\mu = 0.02\) : le taux d'int√©r√™t moyen
\item
  \(\sigma_r = 0.01\) : la volatilit√© du taux d'int√©r√™t
\item
  \(\sigma_s = 0.4\) : la volatilit√© du spread de cr√©dit
\item
  \(\rho = 0.4\) : la corr√©lation entre les deux mouvements browniens
\item
  \(r = 0.02\) : le taux d'int√©r√™t initial
\item
  \(h = 1/12\) : l'horizon de calcul de la VaR
\item
  \(c = 3\%\) : le coupon annuel
\item
  \(R = 40\%\) : le taux de recouvrement
\item
  \(N = 1\) : le nominal de l'obligation
\item
  \(T = 10\) : l'√©ch√©ance de l'obligation
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\KeywordTok{def}\NormalTok{ MC\_VaR(c,T,r,lambda\_,R,N,h,sigma\_r, sigma\_s, rho, alpha}\OperatorTok{=}\FloatTok{0.99}\NormalTok{, N\_MC}\OperatorTok{=}\DecValTok{1000}\NormalTok{,dt}\OperatorTok{=}\DecValTok{1}\NormalTok{):}
    \CommentTok{\# print("Parameters")}
    \CommentTok{\# print(f"coupon : \{c:.2\%\}")}
    \CommentTok{\# print(f"maturity : \{T\} years")}
    \CommentTok{\# print(f"risk free rate : \{r:.2\%\}")}
    \CommentTok{\# print(f"credit spread : \{lambda\_:.2\%\}")}
    \CommentTok{\# print(f"recovery rate : \{R:.2\%\}")}
    \CommentTok{\# print(f"nominal : \{N\}")}

\NormalTok{    prices }\OperatorTok{=}\NormalTok{ []}
    
\NormalTok{    P\_0 }\OperatorTok{=}\NormalTok{ pricing\_bond(t}\OperatorTok{=}\DecValTok{0}\NormalTok{,c}\OperatorTok{=}\NormalTok{c,T}\OperatorTok{=}\NormalTok{T,r}\OperatorTok{=}\NormalTok{r,lambda\_}\OperatorTok{=}\NormalTok{lambda\_,R}\OperatorTok{=}\NormalTok{R,N}\OperatorTok{=}\NormalTok{N,dt}\OperatorTok{=}\NormalTok{dt)}
    \CommentTok{\# print(f"P0 : \{P\_0\}")}

\NormalTok{    s\_0 }\OperatorTok{=}\NormalTok{ lambda\_ }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ R)}
\NormalTok{    r\_0 }\OperatorTok{=}\NormalTok{ r}

    \ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(N\_MC):}
        \CommentTok{\# Generate correlated Brownian motions}
\NormalTok{        W1 }\OperatorTok{=}\NormalTok{ np.random.normal()}
\NormalTok{        W2 }\OperatorTok{=}\NormalTok{ rho }\OperatorTok{*}\NormalTok{ W1 }\OperatorTok{+}\NormalTok{ np.sqrt(}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ rho) }\OperatorTok{*}\NormalTok{ np.random.normal()}

        \CommentTok{\# Euler discretization }
\NormalTok{        r\_h }\OperatorTok{=}\NormalTok{ r\_0 }\OperatorTok{+}\NormalTok{ sigma\_r }\OperatorTok{*}\NormalTok{ np.sqrt(h) }\OperatorTok{*}\NormalTok{ W1}
\NormalTok{        s\_h }\OperatorTok{=}\NormalTok{ s\_0 }\OperatorTok{*}\NormalTok{ ( }\DecValTok{1} \OperatorTok{+}\NormalTok{ sigma\_s }\OperatorTok{*}\NormalTok{ np.sqrt(h) }\OperatorTok{*}\NormalTok{ W2)}
\NormalTok{        lambda\_h }\OperatorTok{=}\NormalTok{ s\_h }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ R)}
        \CommentTok{\# print("="*30)}
        \CommentTok{\# print("Parameters")}
        \CommentTok{\# print(f"coupon : \{c:.2\%\}")}
        \CommentTok{\# print(f"maturity : \{T\} years")}
        \CommentTok{\# print(f"risk free rate : \{r\_h:.2\%\}")}
        \CommentTok{\# print(f"credit spread : \{lambda\_h:.2\%\}")}
        \CommentTok{\# print(f"recovery rate : \{R:.2\%\}")}
        \CommentTok{\# print(f"nominal : \{N\}")}

\NormalTok{        P\_h }\OperatorTok{=}\NormalTok{ pricing\_bond(t}\OperatorTok{=}\NormalTok{h,c}\OperatorTok{=}\NormalTok{c,T}\OperatorTok{=}\NormalTok{T,r}\OperatorTok{=}\NormalTok{r\_h,lambda\_ }\OperatorTok{=}\NormalTok{ lambda\_h,R}\OperatorTok{=}\NormalTok{R,N}\OperatorTok{=}\NormalTok{N,dt}\OperatorTok{=}\NormalTok{dt)}
        \CommentTok{\# print(f"Price : \{P\_h\}")}
\NormalTok{        variation }\OperatorTok{=}\NormalTok{ (P\_h }\OperatorTok{{-}}\NormalTok{ P\_0)}\OperatorTok{/}\NormalTok{P\_0}
\NormalTok{        prices.append(variation)}


\NormalTok{    VaR }\OperatorTok{=}\NormalTok{ np.quantile(prices, }\DecValTok{1} \OperatorTok{{-}}\NormalTok{ alpha)}

    \ControlFlowTok{return}\NormalTok{ VaR}

\NormalTok{sigma\_r }\OperatorTok{=} \FloatTok{0.01}
\NormalTok{sigma\_s }\OperatorTok{=} \FloatTok{0.4}
\NormalTok{rho }\OperatorTok{=} \FloatTok{0.40}

\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{100}
\NormalTok{r }\OperatorTok{=} \DecValTok{2}\OperatorTok{/}\DecValTok{100}
\NormalTok{c }\OperatorTok{=}\DecValTok{3}\OperatorTok{/}\DecValTok{100}
\NormalTok{R }\OperatorTok{=} \DecValTok{40}\OperatorTok{/}\DecValTok{100}
\NormalTok{N}\OperatorTok{=}\DecValTok{1}
\NormalTok{h }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\DecValTok{12}
\NormalTok{T}\OperatorTok{=} \DecValTok{10}

\NormalTok{VaR\_monte\_carlo }\OperatorTok{=}\NormalTok{ MC\_VaR(c,T,r,lambda\_,R,N,h,sigma\_r, sigma\_s, rho, alpha}\OperatorTok{=}\FloatTok{0.99}\NormalTok{, N\_MC}\OperatorTok{=}\DecValTok{1000}\NormalTok{,dt}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"VaR estim√© par Monte Carlo : }\SpecialCharTok{\{}\NormalTok{VaR\_monte\_carlo}\SpecialCharTok{:.4\%\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
VaR estim√© par Monte Carlo : -5.7604%
\end{verbatim}

Lorsque \$ \rho \$ (le coefficient de corr√©lation entre les taux
d'int√©r√™t et le spread de cr√©dit) est positif, une hausse des taux
d'int√©r√™t entra√Æne √©galement une hausse du spread de cr√©dit. Cette
dynamique amplifie le risque global, car les pertes dues √† la hausse des
taux s'ajoutent aux pertes induites par l'√©largissement du spread de
cr√©dit. Ainsi, la Value at Risk (VaR) est plus √©lev√©e, refl√©tant
l'accumulation des risques li√©s aux deux facteurs.

En revanche, lorsque \$ \rho \$ est n√©gatif, une hausse des taux
d'int√©r√™t tend √† r√©duire le spread de cr√©dit, et inversement. Il se cr√©e
alors un effet de compensation : les pertes g√©n√©r√©es par l'√©volution des
taux sont partiellement absorb√©es par les gains r√©sultant de la
contraction du spread (ou inversement). C'est le principe de
diversification. Dans ce cas, la VaR est plus faible, car les effets du
taux d'int√©r√™t et du spread de cr√©dit s'annulent en partie, r√©duisant
ainsi l'ampleur des pertes potentielles.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# VaR en fonction de rho}
\ImportTok{from}\NormalTok{ tqdm }\ImportTok{import}\NormalTok{ tqdm }

\NormalTok{rhos }\OperatorTok{=}\NormalTok{ np.linspace(}\OperatorTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{100}\NormalTok{)}
\NormalTok{VaRs }\OperatorTok{=}\NormalTok{ [MC\_VaR(c,T,r,lambda\_,R,N,h,sigma\_r, sigma\_s, rho, alpha}\OperatorTok{=}\FloatTok{0.99}\NormalTok{, N\_MC}\OperatorTok{=}\DecValTok{1000}\NormalTok{,dt}\OperatorTok{=}\DecValTok{1}\NormalTok{) }\ControlFlowTok{for}\NormalTok{ rho }\KeywordTok{in}\NormalTok{ tqdm(rhos)]}

\NormalTok{plt.plot(rhos,VaRs)}
\NormalTok{plt.title(}\StringTok{"VaR en fonction de la corr√©lation"}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{"rho"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"VaR"}\NormalTok{)}
\NormalTok{plt.grid()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  0%|          | 0/100 [00:00<?, ?it/s] 10%|‚ñà         | 10/100 [00:00<00:00, 93.55it/s] 20%|‚ñà‚ñà        | 20/100 [00:00<00:00, 93.57it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:00<00:00, 93.85it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:00<00:00, 94.21it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:00<00:00, 94.17it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:00<00:00, 94.64it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [00:00<00:00, 94.32it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [00:00<00:00, 94.32it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [00:00<00:00, 94.91it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [00:01<00:00, 94.83it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [00:01<00:00, 94.44it/s]
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{TP-3_files/figure-pdf/cell-26-output-2.pdf}}

\paragraph{Estimation de la volatilit√© du spread de
cr√©dit}\label{estimation-de-la-volatilituxe9-du-spread-de-cruxe9dit}

Pour la volatilit√© du spread, nous avons suppos√© que
\(\sigma_s = 40\%\). Nous allons maintenant estimer cette volatilit√© √†
partir des donn√©es de march√©, en utilisant l'historique des spreads de
cr√©dit sur une p√©riode de 5 ans, i.e.~11/03/2025 - 11/03/2020,
disponible sur ce \href{cds.xlsx}{lien}.

La volatilit√© du spread est une volatilit√© annualis√©e. De ce fait, la
formulation de la volatilit√© empirique, lorsque la fr√©quence est
quotidienne, est la suivante :

\[
\sigma_s = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} (s_i - \bar{s})^2} \times \sqrt{255}
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cds\_df }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{"cds.xlsx"}\NormalTok{, skiprows}\OperatorTok{=}\DecValTok{6}\NormalTok{)}
\CommentTok{\#date as date}
\NormalTok{cds\_df[}\StringTok{"Date"}\NormalTok{] }\OperatorTok{=}\NormalTok{ pd.to\_datetime(cds\_df[}\StringTok{"Date"}\NormalTok{], }\BuiltInTok{format}\OperatorTok{=}\StringTok{"\%Y{-}\%m{-}}\SpecialCharTok{\%d}\StringTok{"}\NormalTok{)}
\NormalTok{cds\_df }\OperatorTok{=}\NormalTok{ cds\_df.set\_index(}\StringTok{"Date"}\NormalTok{)}
\NormalTok{cds\_df }\OperatorTok{=}\NormalTok{ cds\_df.sort\_index()}

\NormalTok{cds\_df.head()}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
& PX\_LAST \\
Date & \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
2020-03-11 & 30.772 \\
2020-03-12 & 36.977 \\
2020-03-13 & 37.869 \\
2020-03-16 & 44.432 \\
2020-03-17 & 49.923 \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vol\_est }\OperatorTok{=}\NormalTok{ np.std(cds\_df[}\StringTok{"PX\_LAST"}\NormalTok{].pct\_change())}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Volatilit√© estim√©e sur 5 ans: }\SpecialCharTok{\{}\NormalTok{vol\_est}\OperatorTok{*}\NormalTok{np}\SpecialCharTok{.}\NormalTok{sqrt(}\DecValTok{255}\NormalTok{)}\SpecialCharTok{:.4f\}}\SpecialStringTok{"}\NormalTok{)}

\CommentTok{\# volatilit√© sur 1 an}
\NormalTok{vol\_est}\OperatorTok{=}\NormalTok{ np.std(cds\_df.loc[}\StringTok{"2024{-}03{-}11"}\NormalTok{:}\StringTok{"2025{-}03{-}11"}\NormalTok{, }\StringTok{"PX\_LAST"}\NormalTok{].pct\_change())}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Volatilit√© estim√©e sur 1 an : }\SpecialCharTok{\{}\NormalTok{vol\_est}\OperatorTok{*}\NormalTok{np}\SpecialCharTok{.}\NormalTok{sqrt(}\DecValTok{255}\NormalTok{)}\SpecialCharTok{:.4f\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Volatilit√© estim√©e sur 5 ans: 0.4512
Volatilit√© estim√©e sur 1 an : 0.5181
\end{verbatim}

\section{Asset management : autres types de
risques}\label{asset-management-autres-types-de-risques}

En dehors du risque de cr√©dit et du risque de march√©, il existe d'autres
types de risques qui peuvent affecter les institutions financi√®res et
les march√©s. Deux d'entre eux sont le risque de mod√®le et le risque
climatique.

\subsection{Risque de mod√®le}\label{risque-de-moduxe8le}

Le risque de mod√®le est le risque associ√© √† une mauvaise utilisation
d'un mod√®le dans le processus de prise de d√©cision. Il peut √™tre caus√©
par :

\begin{itemize}
\tightlist
\item
  une incertitude sur les param√®tres,
\item
  une qualit√© insuffisante des donn√©es,
\item
  ou une inad√©quation structurelle du mod√®le par rapport √† la r√©alit√©
  observ√©e.
\end{itemize}

Ce risque peut conduire √† des erreurs de pr√©vision, √† des d√©cisions
inappropri√©es ou √† des pertes financi√®res. Il est donc essentiel de bien
comprendre les hypoth√®ses et limites des mod√®les employ√©s.

C'est une activit√© o√π l'intervention humaine reste indispensable : il
est n√©cessaire de proc√©der √† des \emph{sanity checks}, du
\emph{backtesting}, et de challenger les mod√®les √† l'aide de versions
plus simples (\emph{d√©g√©n√©r√©es}) ou plus riches, afin d'en comparer les
r√©sultats et de mieux cerner leurs faiblesses.

Pour r√©duire le risque de mod√®le, il est courant de mettre en place une
fonction ind√©pendante de validation, g√©n√©ralement assur√©e par les
√©quipes MRM (Model Risk Management). Ces derni√®res sont charg√©es :

\begin{itemize}
\tightlist
\item
  d'auditer les mod√®les,
\item
  de mener des tests de robustesse,
\item
  et de recommander des provisions en cas de risque de sur√©valuation des
  actifs.
\end{itemize}

Les comp√©tences cl√©s pour cette activit√© incluent : - les math√©matiques
financi√®res, - la connaissance des march√©s financiers et des mod√®les de
risque, - la programmation et l'utilisation d'outils quantitatifs, -
ainsi que des aptitudes √† la communication, au travail en √©quipe et au
raisonnement critique.

\subsection{Risque climatique}\label{risque-climatique}

Le risque climatique d√©signe les impacts potentiels des changements
climatiques et des politiques environnementales sur les entreprises et
les march√©s financiers. Contrairement aux risques classiques, les
trajectoires de r√©f√©rence sont d√©finies par des organismes scientifiques
comme le GIEC, ce qui limite l'appropriation directe des mod√®les par les
institutions financi√®res. Il s'agit donc d'un domaine o√π le risque de
mod√®le est indirect.

Le r√©seau NGFS (Network for Greening the Financial System) a √©t√© mis en
place pour aider les r√©gulateurs et les banques centrales √† mieux
int√©grer les risques climatiques dans leurs cadres prudentiels.

√Ä l'heure actuelle, il n'existe pas de consensus clair sur la mani√®re
d'int√©grer pleinement le risque climatique dans les mod√®les financiers ;
il s'agit plut√¥t de tentatives progressives d'adaptation. Le NGFS
propose plusieurs sc√©narios climatiques, parmi lesquels :

\begin{itemize}
\tightlist
\item
  Current Policies : continuit√© des politiques actuelles sans nouvel
  engagement.
\item
  NDC (Nationally Determined Contributions) : politiques actuelles +
  engagements annonc√©s par les √âtats.
\item
  Disorderly Transition (1.5¬∞C) : les engagements sont mis en ≈ìuvre avec
  retard ou de fa√ßon d√©sorganis√©e.
\item
  Net Zero / 2¬∞C : sc√©nario optimis√© pour limiter le r√©chauffement √† 2¬∞C
  --- le cadre le plus ambitieux et le plus stable.
\end{itemize}

On distingue g√©n√©ralement deux types de risques climatiques :

\subsubsection{1. Risque physique}\label{risque-physique}

Ce risque est li√© aux cons√©quences directes des changements climatiques
sur les infrastructures et l'environnement : - Risques aigus :
√©v√©nements extr√™mes (inondations, s√©cheresses, temp√™tes, etc.). -
Risques chroniques : √©volutions lentes (√©l√©vation du niveau des mers,
hausse des temp√©ratures, etc.).

Ces risques peuvent entra√Æner : - des pertes mat√©rielles, - des
interruptions d'activit√©, - des co√ªts de r√©paration et d'adaptation.

\subsubsection{2. Risque de transition}\label{risque-de-transition}

Ce risque est associ√© aux mesures prises pour r√©duire les √©missions de
gaz √† effet de serre et passer √† une √©conomie bas carbone. Il peut
provoquer : - des pertes de valeur sur certains actifs, - des co√ªts de
transition √©lev√©s, - des bouleversements sectoriels et technologiques.

Il comprend deux composantes : - le risque politique (durcissement
r√©glementaire, interdictions, fiscalit√© verte, etc.), - et le
risque/opportunit√© technologique (√©mergence de nouvelles technologies,
changement dans les pr√©f√©rences de consommation, etc.).

On peut formuler ce risque comme une relation :

\[
\text{Risque de transition} = \text{Risque politique} - \text{Opportunit√©s technologiques}
\]

Ainsi, une entreprise bien positionn√©e sur les technologies vertes peut
compenser tout ou partie du risque politique subi.

\begin{itemize}
\tightlist
\item
  Le risque physique est plus √©lev√© dans les sc√©narios Current Policies,
  NDC, et Disorderly Transition, car ils impliquent une action
  climatique insuffisante ou retard√©e.
\item
  √Ä l'inverse, le risque de transition est plus important dans les
  sc√©narios ambitieux comme Net Zero, o√π les ajustements politiques et
  √©conomiques sont rapides et profonds.
\end{itemize}




\end{document}
